# 快速启动指南

## 前置要求

1. **JDK 17+**
   ```bash
   java -version
   ```

2. **Node.js 18+**
   ```bash
   node --version
   ```

3. **Maven 3.6+**
   ```bash
   mvn --version
   ```

4. **Docker Desktop**
   - Windows/Mac: 下载并安装 Docker Desktop
   - Linux: 安装 Docker 和 Docker Compose

## 一键启动（推荐）

### Windows
```bash
# 启动所有服务（包括Docker、后端和前端）
启动所有服务.bat
```

### Linux/Mac
```bash
# 启动所有服务（包括Docker、后端和前端）
chmod +x start-all.ps1
./start-all.ps1
```

## 手动启动步骤

### 1. 启动基础设施服务

```bash
# 启动MySQL、Redis、Elasticsearch、RabbitMQ
docker-compose up -d

# 检查服务状态
docker ps
```

### 2. 等待数据库初始化

等待约10-15秒，确保MySQL容器完全启动并执行初始化脚本。

### 3. 启动后端服务

```bash
cd hospital-backend

# 安装依赖（首次运行）
mvn clean install

# 启动服务
mvn spring-boot:run
```

后端服务将在 http://localhost:9090 启动

**验证后端服务：**
```bash
# 访问根路径查看API信息
curl http://localhost:9090

# 健康检查
curl http://localhost:9090/api/health
```

**注意：** 所有API接口都需要加上 `/api` 前缀：
- ✅ 正确：http://localhost:9090/api/health
- ✅ 根路径：http://localhost:9090 （显示API信息）
- ❌ 错误：http://localhost:9090/health

### 4. 启动前端服务

打开新的终端窗口：

```bash
cd hospital-frontend

# 安装依赖（首次运行）
npm install

# 启动开发服务器
npm run dev
```

前端服务将在 http://localhost:3000 启动

## 验证系统

1. **访问前端页面**
   - 打开浏览器访问：http://localhost:3000

2. **测试API接口**
   ```bash
   # 健康检查
   curl http://localhost:9090/api/health
   
   # 获取科室列表
   curl http://localhost:9090/api/department/list
   
   # 获取医生列表
   curl http://localhost:9090/api/doctor/list
   ```

3. **检查数据库**
   ```bash
   # 连接MySQL
   docker exec -it hospital-mysql mysql -uhospital_user -phospital123 hospital
   
   # 查看表
   SHOW TABLES;
   
   # 查看患者数据
   SELECT * FROM patient;
   ```

## 常见问题

### 1. Docker服务启动失败

**问题：** `docker-compose up -d` 失败

**解决：**
- 确保Docker Desktop正在运行
- 检查端口是否被占用（3306, 6379, 9200, 5672, 15672）
- 尝试重启Docker服务

### 2. 后端启动失败

**问题：** 连接数据库失败

**解决：**
- 确保MySQL容器已启动：`docker ps | grep mysql`
- 检查数据库配置：`hospital-backend/src/main/resources/application-dev.yml`
- 等待MySQL完全启动（约10-15秒）

### 3. 前端启动失败

**问题：** `npm install` 失败

**解决：**
- 检查Node.js版本：`node --version`（需要18+）
- 清除缓存：`npm cache clean --force`
- 删除node_modules重新安装：`rm -rf node_modules && npm install`

### 4. 端口被占用

**问题：** 端口已被占用

**解决：**
- 修改 `docker-compose.yml` 中的端口映射
- 修改 `application-dev.yml` 中的服务端口
- 修改 `vite.config.ts` 中的前端端口

## 停止服务

```bash
# 停止所有Docker容器
docker-compose down

# 停止后端服务
# 在运行后端的终端按 Ctrl+C

# 停止前端服务
# 在运行前端的终端按 Ctrl+C
```

## 清理数据

```bash
# 停止并删除所有容器和数据卷
docker-compose down -v

# 重新启动（会重新初始化数据库）
docker-compose up -d
```

## 开发建议

1. **后端开发**
   - 使用IntelliJ IDEA打开 `hospital-backend` 目录
   - 安装推荐插件：Lombok、MyBatisX
   - 配置代码格式化规则

2. **前端开发**
   - 使用VS Code打开 `hospital-frontend` 目录
   - 安装推荐插件：Volar、ESLint、Prettier
   - 启用保存时自动格式化

3. **API测试**
   - 使用Postman导入API集合
   - 或使用curl命令测试接口

4. **数据库管理**
   - 使用Navicat、DBeaver等工具连接MySQL
   - 或使用命令行：`docker exec -it hospital-mysql mysql -uhospital_user -phospital123 hospital`

## 下一步

1. 阅读项目文档了解系统设计
2. 查看API接口文档
3. 开始功能开发或测试

